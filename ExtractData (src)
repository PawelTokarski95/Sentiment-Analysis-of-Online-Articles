import pandas as pd
from src.RawData import get_articles


def transform_articles(articles_dict):
    import pandas as pd
    rows = []
    for asset, data in articles_dict.items():
        for article in data['articles']:
            rows.append({
                'asset': asset,
                'source': article.get('source', {}).get('name'),
                'author': article.get('author'),
                'title': article.get('title'),
                'description': article.get('description'),
                'content': article.get('content'),
                'published_at': article.get('publishedAt'),
                'url': article.get('url')
            })
    df = pd.DataFrame(rows)
    return df
